# 技術アーキテクチャ

AIGNE Hub は、信頼性、スケーラビリティ、およびメンテナンスの容易さに最適化されたクラウドネイティブアプリケーションとして設計されています。このアーキテクチャは最新の技術スタックを活用しており、各コンポーネントは高性能な AI ゲートウェイの特定の要求を満たすために選ばれています。システムは自己完結型のユニットとしてデプロイされるように設計されており、外部依存性を最小限に抑え、運用管理を簡素化します。

![logo.png](../../../blocklets/core/screenshots/logo.png)

### コアコンポーネント

アーキテクチャは、いくつかの主要なレイヤーで構成されています。

| コンポーネント | 技術 | 根拠 |
| :--- | :--- | :--- |
| **アプリケーションフレームワーク** | AIGNE フレームワーク | 依存性注入、設定管理、ライフサイクルフックなど、バックエンドサービスの基盤となる構造を提供します。これにより、開発が標準化され、AIGNE エコシステム内でのシームレスな統合が保証されます。 |
| **バックエンドランタイム** | Node.js & TypeScript | Node.js は、そのノンブロッキング、イベント駆動の I/O モデルにより、外部の LLM プロバイダーへの多数の同時 API リクエストを効率的に処理するために使用されます。TypeScript は静的型付けを追加し、コードの品質と保守性を向上させ、実行時エラーを削減します。これは、コアインフラストラクチャサービスにとって重要な機能です。 |
| **フロントエンドインターフェース** | React 19 | 管理ダッシュボードとモデルプレイグラウンドは、最新バージョンの React で構築されています。これにより、設定、監視、テストのためのモダンでレスポンシブ、かつ高性能なユーザーインターフェースが提供されます。 |
| **データストレージ** | SQLite と Sequelize ORM | SQLite はデフォルトの組み込みデータベースとして採用されており、外部データベースサーバーの必要性をなくすことでデプロイを簡素化します。この設計選択により、AIGNE Hub は軽量でインストールが容易になります。Sequelize ORM はデータベースとのやり取りを抽象化し、必要に応じて PostgreSQL のような他の SQL データベースに切り替えて大規模なデプロイに対応する柔軟性を提供します。 |
| **デプロイとパッケージング**| Blocklet | アプリケーション全体は Blocklet としてパッケージ化されます。このクラウドネイティブなコンテナ化アプローチは、アプリケーション、そのランタイム、およびすべての依存関係を単一のデプロイ可能なユニットにカプセル化します。運用チームにとって、これによりどの Blocklet Server インスタンス上でもインストール、アップグレード、スケーリングが大幅に簡素化されます。 |

### システム設計とデータフロー

1.  **リクエストの取り込み**: クライアントアプリケーション（例：AIGNE フレームワーク、AIGNE Studio、またはカスタムスクリプトで構築されたもの）は、AIGNE Hub の RESTful エンドポイント（例：`/api/v2/chat`）に API リクエストを送信します。これらのリクエストは OAuth アクセスキーによって保護されます。
2.  **認証と認可**: Hub のゲートウェイ層がリクエストをインターセプトし、アクセスキーを検証し、関連する権限とユーザーのクレジット残高（サービスプロバイダーモードの場合）を確認します。
3.  **プロバイダーのルーティング**: リクエストパラメータ（例：`model: "openai/gpt-3.5-turbo"`）に基づき、Hub のルーティングロジックが適切な下流の AI プロバイダーを選択します。
4.  **認証情報のインジェクション**: Hub は、対応するプロバイダーの API キーを暗号化されたストレージから安全に取得し、リクエストにインジェクトします。
5.  **API 呼び出しと応答**: Hub は変換されたリクエストをターゲットの AI プロバイダーの API に転送します。応答を受信すると、出力を標準化された形式に正規化します。
6.  **ロギングと分析**: クライアントに応答を返す前に、Hub はトークン使用量、コスト、レイテンシを含むトランザクションの詳細をログに記録します。このデータは、使用状況分析および請求システムを強化します。
7.  **クライアントへの応答**: 最終的に標準化された応答がクライアントアプリケーションに返送されます。

このアーキテクチャにより、AIGNE Hub は堅牢で透明性の高い仲介役として機能し、組織内のすべての AI 運用に対する制御、セキュリティ、可観測性を一元化します。Blocklet 技術の使用は、基盤となるインフラの複雑さを抽象化し、DevOps および SRE チームが Hub を予測可能で、バージョン管理された、スケーラブルなサービスとして管理できるようにします。